<!DOCTYPE html>
<html>
<head>
    <title>Test Soulfra MVP</title>
    <style>
        body { 
            background: #000; 
            color: #00ff88; 
            font-family: monospace; 
            padding: 40px;
        }
        .upload-area {
            border: 3px dashed #00ff88;
            padding: 60px;
            margin: 40px 0;
            cursor: pointer;
        }
        button {
            background: #00ff88;
            color: #000;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            cursor: pointer;
        }
        pre { 
            background: #111; 
            padding: 20px; 
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ü§ñ Test Soulfra MVP</h1>
    
    <div class="upload-area" onclick="document.getElementById('file').click()">
        <p>üìÑ Click to select .txt or .md file</p>
        <input type="file" id="file" style="display:none" accept=".txt,.md" />
    </div>
    
    <div id="result"></div>
    
    <div style="margin-top: 40px; background: #111; padding: 20px;">
        <h3>Debug Console:</h3>
        <pre id="debug">Waiting for file...</pre>
    </div>
    
    <script>
        function log(msg) {
            const debug = document.getElementById('debug');
            debug.textContent += '\n' + new Date().toISOString() + ' - ' + msg;
            console.log(msg);
        }
        
        document.getElementById('file').addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (!file) {
                log('No file selected');
                return;
            }
            
            log('File selected: ' + file.name + ' (' + file.size + ' bytes)');
            
            const formData = new FormData();
            formData.append('file', file);
            
            document.getElementById('result').innerHTML = '<p>‚è≥ Uploading file...</p>';
            
            try {
                log('Sending POST to /api/drop...');
                
                const response = await fetch('http://localhost:3001/api/drop', {
                    method: 'POST',
                    body: formData
                });
                
                log('Response status: ' + response.status);
                
                const text = await response.text();
                log('Response body: ' + text.substring(0, 200) + '...');
                
                let data;
                try {
                    data = JSON.parse(text);
                } catch (e) {
                    throw new Error('Invalid JSON response: ' + text);
                }
                
                document.getElementById('result').innerHTML = 
                    '<h3>‚úÖ Success!</h3>' +
                    '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
                    
            } catch (error) {
                log('ERROR: ' + error.message);
                document.getElementById('result').innerHTML = 
                    '<p style="color: red;">‚ùå Error: ' + error.message + '</p>';
            }
        });
        
        log('Page loaded, ready for file upload');
    </script>
</body>
</html>
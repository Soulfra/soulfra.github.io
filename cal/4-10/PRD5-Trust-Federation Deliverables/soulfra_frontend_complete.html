<!-- ===== MAIN HTML INTERFACE (web/index.html) ===== -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soulfra Knowledge Orchestrator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .drag-over {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            border: 2px dashed #fff;
        }
        .knowledge-graph-node {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .knowledge-graph-node:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <div x-data="soulfraApp()" class="flex h-screen">
        <!-- Sidebar -->
        <div class="w-64 bg-gray-800 border-r border-gray-700 flex flex-col">
            <!-- Logo -->
            <div class="p-6 border-b border-gray-700">
                <h1 class="text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent">
                    üß† Soulfra Orchestrator
                </h1>
                <p class="text-gray-400 text-sm mt-1">Your AI Knowledge Hub</p>
            </div>

            <!-- Stats -->
            <div class="p-4 space-y-3">
                <div class="bg-gray-700 rounded-lg p-3">
                    <div class="flex items-center justify-between">
                        <span class="text-gray-300 text-sm">Documents</span>
                        <span class="text-blue-400 font-semibold" x-text="stats.totalDocuments"></span>
                    </div>
                </div>
                <div class="bg-gray-700 rounded-lg p-3">
                    <div class="flex items-center justify-between">
                        <span class="text-gray-300 text-sm">Concepts</span>
                        <span class="text-purple-400 font-semibold" x-text="stats.totalConcepts"></span>
                    </div>
                </div>
                <div class="bg-gray-700 rounded-lg p-3">
                    <div class="flex items-center justify-between">
                        <span class="text-gray-300 text-sm">Relationships</span>
                        <span class="text-green-400 font-semibold" x-text="stats.totalRelationships"></span>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 p-4">
                <div class="space-y-2">
                    <button @click="activeTab = 'dashboard'" 
                            :class="activeTab === 'dashboard' ? 'bg-blue-600' : 'hover:bg-gray-700'"
                            class="w-full text-left px-3 py-2 rounded-lg transition-colors">
                        <i class="fas fa-tachometer-alt mr-2"></i> Dashboard
                    </button>
                    <button @click="activeTab = 'documents'" 
                            :class="activeTab === 'documents' ? 'bg-blue-600' : 'hover:bg-gray-700'"
                            class="w-full text-left px-3 py-2 rounded-lg transition-colors">
                        <i class="fas fa-file-alt mr-2"></i> Documents
                    </button>
                    <button @click="activeTab = 'query'" 
                            :class="activeTab === 'query' ? 'bg-blue-600' : 'hover:bg-gray-700'"
                            class="w-full text-left px-3 py-2 rounded-lg transition-colors">
                        <i class="fas fa-brain mr-2"></i> Ask AI
                    </button>
                    <button @click="activeTab = 'knowledge'" 
                            :class="activeTab === 'knowledge' ? 'bg-blue-600' : 'hover:bg-gray-700'"
                            class="w-full text-left px-3 py-2 rounded-lg transition-colors">
                        <i class="fas fa-project-diagram mr-2"></i> Knowledge Graph
                    </button>
                    <button @click="activeTab = 'sync'" 
                            :class="activeTab === 'sync' ? 'bg-blue-600' : 'hover:bg-gray-700'"
                            class="w-full text-left px-3 py-2 rounded-lg transition-colors">
                        <i class="fas fa-cloud-upload-alt mr-2"></i> Sync
                    </button>
                </div>
            </nav>

            <!-- Quick Actions -->
            <div class="p-4 border-t border-gray-700 space-y-2">
                <button @click="openFileDialog()" 
                        class="w-full bg-green-600 hover:bg-green-700 px-3 py-2 rounded-lg transition-colors">
                    <i class="fas fa-plus mr-2"></i> Add Files
                </button>
                <button @click="syncWithDrive()" 
                        :disabled="syncing"
                        class="w-full bg-purple-600 hover:bg-purple-700 disabled:opacity-50 px-3 py-2 rounded-lg transition-colors">
                    <i class="fas fa-sync-alt mr-2" :class="{ 'fa-spin': syncing }"></i> Sync Drive
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col">
            <!-- Header -->
            <header class="bg-gray-800 border-b border-gray-700 px-6 py-4">
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-xl font-semibold capitalize" x-text="activeTab"></h2>
                        <p class="text-gray-400 text-sm" x-text="getTabDescription()"></p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="text-sm text-gray-400">
                            Last sync: <span x-text="lastSyncTime"></span>
                        </div>
                        <div :class="connectionStatus === 'connected' ? 'text-green-400' : 'text-red-400'" 
                             class="flex items-center space-x-1">
                            <div class="w-2 h-2 rounded-full" 
                                 :class="connectionStatus === 'connected' ? 'bg-green-400' : 'bg-red-400'"></div>
                            <span class="text-sm capitalize" x-text="connectionStatus"></span>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 p-6 overflow-auto">
                <!-- Dashboard Tab -->
                <div x-show="activeTab === 'dashboard'" class="space-y-6">
                    <!-- File Drop Zone -->
                    <div class="bg-gradient-to-br from-gray-800 to-gray-900 border-2 border-dashed border-gray-600 rounded-xl p-8 text-center"
                         @dragover.prevent="isDragging = true"
                         @dragleave.prevent="isDragging = false"
                         @drop.prevent="handleFileDrop($event)"
                         :class="{ 'drag-over': isDragging }">
                        <div class="space-y-4">
                            <div class="text-6xl text-gray-500">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div>
                                <h3 class="text-xl font-semibold mb-2">Drop Your Documents Here</h3>
                                <p class="text-gray-400">Drag & drop files to organize and train your AI assistant</p>
                            </div>
                            <div class="flex justify-center space-x-4 text-sm text-gray-500">
                                <span><i class="fas fa-file-pdf mr-1"></i> PDF</span>
                                <span><i class="fas fa-file-word mr-1"></i> DOCX</span>
                                <span><i class="fas fa-file-alt mr-1"></i> TXT</span>
                                <span><i class="fas fa-markdown mr-1"></i> MD</span>
                                <span><i class="fas fa-image mr-1"></i> Images</span>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Recent Documents -->
                        <div class="bg-gray-800 rounded-xl p-6">
                            <h3 class="text-lg font-semibold mb-4 flex items-center">
                                <i class="fas fa-clock mr-2 text-blue-400"></i> Recent Documents
                            </h3>
                            <div class="space-y-3">
                                <template x-for="doc in recentDocuments" :key="doc.id">
                                    <div class="flex items-center justify-between p-3 bg-gray-700 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold"
                                                 :class="getCategoryColor(doc.category)">
                                                <span x-text="doc.category.charAt(0)"></span>
                                            </div>
                                            <div>
                                                <div class="font-medium" x-text="doc.filename"></div>
                                                <div class="text-sm text-gray-400" x-text="doc.category"></div>
                                            </div>
                                        </div>
                                        <div class="text-xs text-gray-500" x-text="formatDate(doc.created_at)"></div>
                                    </div>
                                </template>
                            </div>
                        </div>

                        <!-- Category Breakdown -->
                        <div class="bg-gray-800 rounded-xl p-6">
                            <h3 class="text-lg font-semibold mb-4 flex items-center">
                                <i class="fas fa-chart-pie mr-2 text-purple-400"></i> Document Categories
                            </h3>
                            <div class="space-y-3">
                                <template x-for="category in stats.categoriesBreakdown" :key="category.category">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 rounded-full" :class="getCategoryColor(category.category).split(' ')[0]"></div>
                                            <span x-text="category.category"></span>
                                        </div>
                                        <span class="font-semibold" x-text="category.count"></span>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Documents Tab -->
                <div x-show="activeTab === 'documents'" class="space-y-6">
                    <!-- Search and Filters -->
                    <div class="flex space-x-4">
                        <div class="flex-1">
                            <input type="text" 
                                   x-model="searchQuery"
                                   @input="searchDocuments()"
                                   placeholder="Search documents..."
                                   class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500">
                        </div>
                        <select x-model="categoryFilter" 
                                @change="filterDocuments()"
                                class="bg-gray-800 border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:border-blue-500">
                            <option value="">All Categories</option>
                            <option value="PRDs">PRDs</option>
                            <option value="Architecture">Architecture</option>
                            <option value="Business">Business</option>
                            <option value="Ideas">Ideas</option>
                            <option value="Code">Code</option>
                            <option value="Research">Research</option>
                        </select>
                    </div>

                    <!-- Documents Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <template x-for="doc in filteredDocuments" :key="doc.id">
                            <div class="bg-gray-800 rounded-lg p-4 hover:bg-gray-750 transition-colors cursor-pointer"
                                 @click="openDocument(doc)">
                                <div class="flex items-start justify-between mb-3">
                                    <div class="flex items-center space-x-2">
                                        <div class="w-6 h-6 rounded-full flex items-center justify-center text-xs font-semibold"
                                             :class="getCategoryColor(doc.category)">
                                            <span x-text="doc.category.charAt(0)"></span>
                                        </div>
                                        <span class="text-sm text-gray-400" x-text="doc.category"></span>
                                    </div>
                                    <div class="text-xs text-gray-500" x-text="formatDate(doc.created_at)"></div>
                                </div>
                                <h3 class="font-medium mb-2 truncate" x-text="doc.filename"></h3>
                                <p class="text-sm text-gray-400 line-clamp-3" x-text="doc.summary"></p>
                                <div class="mt-3 flex flex-wrap gap-1">
                                    <template x-for="tag in JSON.parse(doc.tags || '[]').slice(0, 3)" :key="tag">
                                        <span class="px-2 py-1 bg-blue-600 text-xs rounded-full" x-text="tag"></span>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>

                <!-- AI Query Tab -->
                <div x-show="activeTab === 'query'" class="space-y-6">
                    <!-- Query Input -->
                    <div class="bg-gray-800 rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-brain mr-2 text-blue-400"></i> Ask Your AI Assistant
                        </h3>
                        <div class="space-y-4">
                            <textarea x-model="currentQuery"
                                      @keydown.meta.enter="submitQuery()"
                                      placeholder="Ask anything about your Soulfra documentation..."
                                      class="w-full bg-gray-700 border border-gray-600 rounded-lg p-4 h-24 resize-none focus:outline-none focus:border-blue-500"></textarea>
                            <div class="flex justify-between items-center">
                                <div class="text-sm text-gray-400">
                                    Cmd+Enter to submit ‚Ä¢ Trained on <span x-text="stats.totalDocuments"></span> documents
                                </div>
                                <button @click="submitQuery()" 
                                        :disabled="!currentQuery.trim() || queryLoading"
                                        class="bg-blue-600 hover:bg-blue-700 disabled:opacity-50 px-6 py-2 rounded-lg transition-colors">
                                    <span x-show="!queryLoading">Ask AI</span>
                                    <span x-show="queryLoading" class="flex items-center">
                                        <i class="fas fa-spinner fa-spin mr-2"></i> Thinking...
                                    </span>
                                </button>
                            </div>
                        </div>

                        <!-- Quick Questions -->
                        <div class="mt-4">
                            <div class="text-sm text-gray-400 mb-2">Quick questions:</div>
                            <div class="flex flex-wrap gap-2">
                                <button @click="currentQuery = 'What is the core architecture of Soulfra?'" 
                                        class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded-full text-sm transition-colors">
                                    Soulfra architecture
                                </button>
                                <button @click="currentQuery = 'What features should I build first?'" 
                                        class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded-full text-sm transition-colors">
                                    Feature priorities
                                </button>
                                <button @click="currentQuery = 'How does the trust system work?'" 
                                        class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded-full text-sm transition-colors">
                                    Trust system
                                </button>
                                <button @click="currentQuery = 'Generate code for agent marketplace'" 
                                        class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded-full text-sm transition-colors">
                                    Generate code
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Query Response -->
                    <div x-show="queryResponse" class="bg-gray-800 rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-robot mr-2 text-green-400"></i> AI Response
                            <span class="ml-auto text-sm font-normal text-gray-400">
                                Confidence: <span x-text="Math.round((queryResponse?.confidence || 0) * 100)"></span>%
                            </span>
                        </h3>
                        <div class="prose prose-invert max-w-none">
                            <div class="whitespace-pre-wrap" x-text="queryResponse?.answer"></div>
                        </div>
                        
                        <!-- Sources -->
                        <div x-show="queryResponse?.sources?.length > 0" class="mt-6">
                            <h4 class="text-sm font-semibold text-gray-300 mb-2">Sources:</h4>
                            <div class="flex flex-wrap gap-2">
                                <template x-for="source in queryResponse.sources" :key="source.filename">
                                    <div class="bg-gray-700 rounded-lg px-3 py-2 text-sm">
                                        <div class="font-medium" x-text="source.filename"></div>
                                        <div class="text-gray-400" x-text="source.category"></div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Knowledge Graph Tab -->
                <div x-show="activeTab === 'knowledge'" class="space-y-6">
                    <div class="bg-gray-800 rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-project-diagram mr-2 text-purple-400"></i> Knowledge Graph
                        </h3>
                        <div id="knowledge-graph" class="h-96 bg-gray-900 rounded-lg flex items-center justify-center">
                            <div class="text-gray-500">
                                <i class="fas fa-project-diagram text-4xl mb-4"></i>
                                <div>Knowledge graph visualization coming soon...</div>
                                <div class="text-sm mt-2">Connect documents based on relationships and concepts</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sync Tab -->
                <div x-show="activeTab === 'sync'" class="space-y-6">
                    <div class="bg-gray-800 rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-4 flex items-center">
                            <i class="fas fa-cloud-upload-alt mr-2 text-blue-400"></i> Google Drive Sync
                        </h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                                <div>
                                    <div class="font-medium">Auto-sync Status</div>
                                    <div class="text-sm text-gray-400">Automatically sync changes to Google Drive</div>
                                </div>
                                <button class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition-colors">
                                    Enabled
                                </button>
                            </div>
                            
                            <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                                <div>
                                    <div class="font-medium">Manual Sync</div>
                                    <div class="text-sm text-gray-400">Force sync all documents now</div>
                                </div>
                                <button @click="syncWithDrive()" 
                                        :disabled="syncing"
                                        class="bg-blue-600 hover:bg-blue-700 disabled:opacity-50 px-4 py-2 rounded-lg transition-colors">
                                    <span x-show="!syncing">Sync Now</span>
                                    <span x-show="syncing" class="flex items-center">
                                        <i class="fas fa-spinner fa-spin mr-2"></i> Syncing...
                                    </span>
                                </button>
                            </div>

                            <div class="flex items-center justify-between p-4 bg-gray-700 rounded-lg">
                                <div>
                                    <div class="font-medium">Create Backup</div>
                                    <div class="text-sm text-gray-400">Create a full backup in Google Drive</div>
                                </div>
                                <button @click="createBackup()" 
                                        class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg transition-colors">
                                    Create Backup
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Sync Status -->
                    <div x-show="syncStatus" class="bg-gray-800 rounded-xl p-6">
                        <h3 class="text-lg font-semibold mb-4">Sync Status</h3>
                        <div class="space-y-2 text-sm">
                            <div>Last sync: <span x-text="lastSyncTime"></span></div>
                            <div>Status: <span x-text="syncStatus"></span></div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div x-show="loading" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-gray-800 rounded-xl p-8 max-w-md">
            <div class="text-center">
                <i class="fas fa-spinner fa-spin text-4xl text-blue-400 mb-4"></i>
                <h3 class="text-lg font-semibold mb-2">Processing Files</h3>
                <p class="text-gray-400" x-text="loadingMessage"></p>
            </div>
        </div>
    </div>

    <script>
        const { ipcRenderer } = require('electron');

        function soulfraApp() {
            return {
                // State
                activeTab: 'dashboard',
                loading: false,
                loadingMessage: '',
                syncing: false,
                isDragging: false,
                connectionStatus: 'connected',
                lastSyncTime: 'Never',
                
                // Data
                documents: [],
                recentDocuments: [],
                filteredDocuments: [],
                stats: {
                    totalDocuments: 0,
                    totalConcepts: 0,
                    totalRelationships: 0,
                    categoriesBreakdown: []
                },
                
                // Query
                currentQuery: '',
                queryResponse: null,
                queryLoading: false,
                
                // Filters
                searchQuery: '',
                categoryFilter: '',
                syncStatus: '',

                // Initialize
                async init() {
                    await this.loadData();
                    this.setupEventListeners();
                    
                    // Check connection status
                    setInterval(() => {
                        this.checkConnection();
                    }, 30000);
                },

                async loadData() {
                    try {
                        // Load documents
                        const docsResult = await ipcRenderer.invoke('get-documents');
                        if (docsResult.success) {
                            this.documents = docsResult.documents;
                            this.filteredDocuments = [...this.documents];
                            this.recentDocuments = this.documents.slice(0, 5);
                        }

                        // Load stats
                        const statsResult = await ipcRenderer.invoke('get-stats');
                        if (statsResult.success) {
                            this.stats = statsResult.stats;
                        }
                    } catch (error) {
                        console.error('Failed to load data:', error);
                    }
                },

                setupEventListeners() {
                    // File selection from menu
                    ipcRenderer.on('files-selected', (event, filePaths) => {
                        this.processFiles(filePaths);
                    });

                    // Focus query input
                    ipcRenderer.on('focus-query', () => {
                        this.activeTab = 'query';
                        this.$nextTick(() => {
                            const textarea = document.querySelector('textarea');
                            if (textarea) textarea.focus();
                        });
                    });

                    // Sync events
                    ipcRenderer.on('sync-started', () => {
                        this.syncing = true;
                        this.syncStatus = 'Syncing...';
                    });

                    ipcRenderer.on('sync-completed', (event, result) => {
                        this.syncing = false;
                        this.syncStatus = result.message;
                        this.lastSyncTime = new Date().toLocaleTimeString();
                    });
                },

                // File handling
                async handleFileDrop(event) {
                    this.isDragging = false;
                    const files = Array.from(event.dataTransfer.files);
                    const filePaths = files.map(file => file.path);
                    await this.processFiles(filePaths);
                },

                async openFileDialog() {
                    const result = await ipcRenderer.invoke('open-file-dialog');
                    if (!result.canceled && result.filePaths.length > 0) {
                        await this.processFiles(result.filePaths);
                    }
                },

                async processFiles(filePaths) {
                    this.loading = true;
                    this.loadingMessage = `Processing ${filePaths.length} file(s)...`;
                    
                    try {
                        const result = await ipcRenderer.invoke('process-files', filePaths);
                        
                        if (result.success) {
                            await this.loadData(); // Refresh data
                            this.loadingMessage = `Successfully processed ${result.results.length} files!`;
                            
                            // Show success briefly then hide
                            setTimeout(() => {
                                this.loading = false;
                            }, 2000);
                        } else {
                            throw new Error(result.error);
                        }
                    } catch (error) {
                        console.error('File processing failed:', error);
                        this.loadingMessage = `Error: ${error.message}`;
                        setTimeout(() => {
                            this.loading = false;
                        }, 3000);
                    }
                },

                // AI Query
                async submitQuery() {
                    if (!this.currentQuery.trim()) return;
                    
                    this.queryLoading = true;
                    this.queryResponse = null;
                    
                    try {
                        const result = await ipcRenderer.invoke('query-knowledge', this.currentQuery);
                        
                        if (result.success) {
                            this.queryResponse = result.result;
                        } else {
                            throw new Error(result.error);
                        }
                    } catch (error) {
                        console.error('Query failed:', error);
                        this.queryResponse = {
                            answer: `Sorry, I encountered an error: ${error.message}`,
                            sources: [],
                            confidence: 0
                        };
                    } finally {
                        this.queryLoading = false;
                    }
                },

                // Search and filtering
                searchDocuments() {
                    this.filterDocuments();
                },

                filterDocuments() {
                    let filtered = [...this.documents];
                    
                    // Apply search filter
                    if (this.searchQuery.trim()) {
                        const query = this.searchQuery.toLowerCase();
                        filtered = filtered.filter(doc => 
                            doc.filename.toLowerCase().includes(query) ||
                            doc.summary.toLowerCase().includes(query) ||
                            JSON.parse(doc.tags || '[]').some(tag => 
                                tag.toLowerCase().includes(query)
                            )
                        );
                    }
                    
                    // Apply category filter
                    if (this.categoryFilter) {
                        filtered = filtered.filter(doc => doc.category === this.categoryFilter);
                    }
                    
                    this.filteredDocuments = filtered;
                },

                // Sync operations
                async syncWithDrive() {
                    this.syncing = true;
                    this.syncStatus = 'Syncing with Google Drive...';
                    
                    try {
                        const result = await ipcRenderer.invoke('sync-drive');
                        
                        if (result.success) {
                            this.syncStatus = result.result.message;
                            this.lastSyncTime = new Date().toLocaleTimeString();
                        } else {
                            this.syncStatus = `Sync failed: ${result.error}`;
                        }
                    } catch (error) {
                        console.error('Sync failed:', error);
                        this.syncStatus = `Sync error: ${error.message}`;
                    } finally {
                        this.syncing = false;
                    }
                },

                async createBackup() {
                    // Implementation for backup creation
                    console.log('Creating backup...');
                },

                // Utility functions
                openDocument(doc) {
                    // Open document in default app or show details
                    console.log('Opening document:', doc);
                },

                checkConnection() {
                    // Ping health endpoint or check services
                    this.connectionStatus = 'connected';
                },

                getTabDescription() {
                    const descriptions = {
                        dashboard: 'Overview of your knowledge base and quick actions',
                        documents: 'Browse and search your organized documents',
                        query: 'Ask your AI assistant questions about your knowledge',
                        knowledge: 'Visualize relationships between your documents',
                        sync: 'Manage synchronization with Google Drive'
                    };
                    return descriptions[this.activeTab] || '';
                },

                getCategoryColor(category) {
                    const colors = {
                        'PRDs': 'bg-blue-600 text-white',
                        'Architecture': 'bg-purple-600 text-white',
                        'Business': 'bg-green-600 text-white',
                        'Ideas': 'bg-yellow-600 text-white',
                        'Code': 'bg-red-600 text-white',
                        'Research': 'bg-indigo-600 text-white'
                    };
                    return colors[category] || 'bg-gray-600 text-white';
                },

                formatDate(dateStr) {
                    return new Date(dateStr).toLocaleDateString();
                }
            }
        }
    </script>
</body>
</html>

<!-- ===== SETUP SCRIPT (scripts/setup.js) ===== -->
<script>
const fs = require('fs-extra');
const path = require('path');
const readline = require('readline');
const { google } = require('googleapis');

class SoulfraSetup {
  constructor() {
    this.rl = readline.createInterface({
      input: process.stdin,
      output: process.stdout
    });
  }

  async run() {
    console.log(`
üß† SOULFRA KNOWLEDGE ORCHESTRATOR SETUP
=======================================

Welcome! Let's set up your AI-powered knowledge orchestrator.
    `);

    try {
      await this.createDirectories();
      await this.setupEnvironment();
      await this.setupGoogleDrive();
      await this.createSampleData();
      
      console.log(`
‚úÖ SETUP COMPLETE!

Your Soulfra Knowledge Orchestrator is ready to use.

Next steps:
1. Run: npm start
2. Drop your documents into the app
3. Start querying your AI assistant

Your organized documents will be in: ./Soulfra-Documentation/
      `);
      
    } catch (error) {
      console.error('‚ùå Setup failed:', error.message);
    } finally {
      this.rl.close();
    }
  }

  async createDirectories() {
    console.log('üìÅ Creating directory structure...');
    
    const dirs = [
      'Soulfra-Documentation',
      'Soulfra-Documentation/PRDs',
      'Soulfra-Documentation/Architecture',
      'Soulfra-Documentation/Business',
      'Soulfra-Documentation/Ideas',
      'Soulfra-Documentation/Code',
      'Soulfra-Documentation/Research'
    ];

    for (const dir of dirs) {
      await fs.ensureDir(dir);
    }

    console.log('‚úÖ Directories created');
  }

  async setupEnvironment() {
    console.log('‚öôÔ∏è Setting up environment...');
    
    const envPath = path.join(process.cwd(), '.env');
    
    if (!(await fs.pathExists(envPath))) {
      const envContent = `# Soulfra Knowledge Orchestrator Environment
# Add your API keys here

# OpenAI API Key (optional)
OPENAI_API_KEY=

# Anthropic API Key (optional)  
ANTHROPIC_API_KEY=

# Development mode
NODE_ENV=development
`;
      
      await fs.writeFile(envPath, envContent);
      console.log('‚úÖ .env file created');
      console.log('üí° Add your AI API keys to .env for full functionality');
    } else {
      console.log('‚úÖ .env file already exists');
    }
  }

  async setupGoogleDrive() {
    console.log('\n‚òÅÔ∏è Google Drive Setup (Optional)');
    
    const useGoogleDrive = await this.askQuestion('Do you want to set up Google Drive sync? (y/n): ');
    
    if (useGoogleDrive.toLowerCase() === 'y') {
      console.log(`
To enable Google Drive sync:

1. Go to: https://console.developers.google.com/
2. Create a new project or select existing
3. Enable the Google Drive API
4. Create credentials (OAuth 2.0 Client ID) for Desktop application
5. Download the JSON file and save it as 'credentials.json' in this directory

After you have credentials.json, run the app and it will guide you through authentication.
      `);
      
      await this.askQuestion('Press Enter when you understand...');
    } else {
      console.log('‚úÖ Skipping Google Drive setup');
    }
  }

  async createSampleData() {
    console.log('üìÑ Creating sample documents...');
    
    const samplePRD = `# Sample PRD: Soulfra Agent Marketplace

## Overview
A marketplace where users can create, share, and monetize AI agents.

## Key Features
- Agent builder interface
- Revenue sharing (70/30 split)
- Discovery and search
- Usage analytics

## Success Metrics
- 100+ agents in first month
- $10K+ monthly transactions
- 4.5+ average rating

## Implementation Timeline
- Week 1: Basic marketplace structure
- Week 2: Agent builder
- Week 3: Payment integration
- Week 4: Launch
`;

    const sampleArchitecture = `# Soulfra Architecture Overview

## Core Components

### Trust Engine
- Reputation scoring
- Behavior analysis
- Cross-platform federation

### Infinity Router
- Multi-provider AI routing
- Cost optimization
- Failover logic

### Agent Runtime
- Sandboxed execution
- Resource management
- Performance monitoring

## Data Flow
1. User request ‚Üí Trust validation
2. Router selects optimal AI provider
3. Agent processes request
4. Response returned with trust update
`;

    const sampleBusiness = `# Soulfra Business Strategy

## Revenue Model
- Platform fees (30% of transactions)
- Premium subscriptions ($20/month)
- Enterprise licenses ($500+/month)

## Competitive Advantages
1. Trust-first architecture
2. Multi-provider AI routing
3. Agent marketplace network effects
4. Privacy-preserving design

## Market Opportunity
- Total Addressable Market: $50B
- Serviceable Addressable Market: $5B
- Target: 1% market share in 3 years
`;

    await fs.writeFile(
      path.join('Soulfra-Documentation', 'PRDs', 'sample-agent-marketplace.md'),
      samplePRD
    );
    
    await fs.writeFile(
      path.join('Soulfra-Documentation', 'Architecture', 'sample-architecture.md'),
      sampleArchitecture
    );
    
    await fs.writeFile(
      path.join('Soulfra-Documentation', 'Business', 'sample-business-strategy.md'),
      sampleBusiness
    );

    console.log('‚úÖ Sample documents created');
  }

  askQuestion(question) {
    return new Promise((resolve) => {
      this.rl.question(question, (answer) => {
        resolve(answer);
      });
    });
  }
}

// Run setup if called directly
if (require.main === module) {
  const setup = new SoulfraSetup();
  setup.run();
}

module.exports = SoulfraSetup;
</script>

<!-- ===== INSTALLER SCRIPT (install.sh) ===== -->
<script type="text/bash">
#!/bin/bash

# SOULFRA KNOWLEDGE ORCHESTRATOR - ONE-CLICK INSTALLER
echo "üß† SOULFRA KNOWLEDGE ORCHESTRATOR INSTALLER"
echo "============================================="

# Colors
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m'

# Check Node.js
echo -e "${BLUE}Checking Node.js...${NC}"
if ! command -v node &> /dev/null; then
    echo -e "${RED}‚ùå Node.js not found${NC}"
    echo "Please install Node.js 16+ from https://nodejs.org"
    exit 1
fi

NODE_VERSION=$(node -v | cut -d'v' -f2 | cut -d'.' -f1)
if [ "$NODE_VERSION" -lt "16" ]; then
    echo -e "${RED}‚ùå Node.js version $NODE_VERSION is too old${NC}"
    echo "Please upgrade to Node.js 16+ from https://nodejs.org"
    exit 1
fi

echo -e "${GREEN}‚úÖ Node.js $(node -v) found${NC}"

# Install dependencies
echo -e "${BLUE}Installing dependencies...${NC}"
npm install
if [ $? -ne 0 ]; then
    echo -e "${RED}‚ùå Failed to install dependencies${NC}"
    exit 1
fi

echo -e "${GREEN}‚úÖ Dependencies installed${NC}"

# Run setup
echo -e "${BLUE}Running initial setup...${NC}"
node scripts/setup.js
if [ $? -ne 0 ]; then
    echo -e "${RED}‚ùå Setup failed${NC}"
    exit 1
fi

echo -e "${GREEN}‚úÖ Setup completed${NC}"

# Create desktop shortcut (optional)
echo -e "${BLUE}Creating launcher...${NC}"
cat > soulfra-start.sh << 'EOF'
#!/bin/bash
cd "$(dirname "$0")"
npm start
EOF

chmod +x soulfra-start.sh
echo -e "${GREEN}‚úÖ Launcher created: ./soulfra-start.sh${NC}"

echo -e "
${GREEN}üéâ INSTALLATION COMPLETE!${NC}

${YELLOW}To start Soulfra Knowledge Orchestrator:${NC}
  ./soulfra-start.sh
  
${YELLOW}Or manually:${NC}
  npm start

${YELLOW}Next steps:${NC}
1. Add your AI API keys to .env (optional but recommended)
2. Set up Google Drive sync (optional)
3. Start organizing your documents!

${BLUE}Happy knowledge orchestrating! üß†${NC}
"
</script>

<!-- ===== README (README.md) ===== -->
<script type="markdown">
# üß† Soulfra Knowledge Orchestrator

Your AI-powered knowledge hub that organizes documents, learns from your ideas, and becomes your competitive advantage in building Soulfra.

## üöÄ Quick Start

### One-Click Installation
```bash
curl -sSL https://raw.githubusercontent.com/your-repo/soulfra-orchestrator/main/install.sh | bash
```

### Manual Installation
```bash
git clone https://github.com/your-repo/soulfra-orchestrator.git
cd soulfra-orchestrator
chmod +x install.sh
./install.sh
```

### Start the Application
```bash
npm start
# or
./soulfra-start.sh
```

## ‚ú® Features

### üóÇÔ∏è Smart File Organization
- **Drag & Drop**: Drop files from Downloads ‚Üí Auto-categorized
- **AI Categorization**: Automatically sorts into PRDs, Architecture, Business, etc.
- **Multi-format Support**: PDF, DOCX, TXT, MD, Images (with OCR)

### üß† AI Knowledge Assistant
- **Trained on YOUR docs**: AI learns your complete Soulfra vision
- **Context-aware responses**: Answers based on your documentation
- **Code generation**: Creates Soulfra-optimized code from your specs
- **Strategic insights**: Business advice based on your research

### ‚òÅÔ∏è Seamless Sync
- **Google Drive Integration**: Automatic cloud sync
- **Cross-platform**: Desktop, mobile (coming soon)
- **Conflict Resolution**: Smart merging when files change
- **Version History**: Track how your ideas evolve

### üìä Knowledge Graph
- **Relationship Mapping**: See how your documents connect
- **Concept Extraction**: AI identifies key concepts and themes
- **Visual Discovery**: Find related ideas you forgot about

## üéØ The Original Affiliate Strategy

This isn't just a document manager - it's your **competitive advantage**:

1. **Knowledge Monopoly**: Your AI understands Soulfra better than any external system
2. **Development Speed**: 10x faster feature development with AI assistance
3. **Strategic Foresight**: AI predicts market needs from your research
4. **Technical Excellence**: AI-optimized architecture and code

## üìã Requirements

- Node.js 16+
- 2GB RAM
- 1GB storage space
- Google Drive account (optional)
- AI API keys (optional but recommended):
  - OpenAI API key
  - Anthropic API key

## ‚öôÔ∏è Configuration

### Environment Variables (.env)
```bash
# AI API Keys (optional)
OPENAI_API_KEY=your_openai_key
ANTHROPIC_API_KEY=your_anthropic_key

# Development
NODE_ENV=development
```

### Google Drive Setup
1. Go to [Google Cloud Console](https://console.developers.google.com/)
2. Create project ‚Üí Enable Google Drive API
3. Create OAuth 2.0 credentials for Desktop app
4. Download JSON ‚Üí Save as `credentials.json`
5. Run app ‚Üí Follow authentication flow

## üóÇÔ∏è Directory Structure

```
Soulfra-Documentation/
‚îú‚îÄ‚îÄ PRDs/              # Product requirements
‚îú‚îÄ‚îÄ Architecture/      # System design docs
‚îú‚îÄ‚îÄ Business/          # Strategy and market research
‚îú‚îÄ‚îÄ Ideas/             # Brainstorms and concepts
‚îú‚îÄ‚îÄ Code/              # Implementation files
‚îú‚îÄ‚îÄ Research/          # Competitive analysis
‚îî‚îÄ‚îÄ knowledge.db       # AI knowledge base
```

## ü§ñ AI Capabilities

### Document Analysis
- Content extraction (PDF, DOCX, images)
- Automatic categorization
- Concept extraction
- Relationship mapping

### Knowledge Queries
```
"What is the core architecture of Soulfra?"
"What features should I build first?"
"Generate code for the agent marketplace"
"How does our trust system compare to competitors?"
```

### Code Generation
- Soulfra-optimized implementations
- Architecture-aware suggestions
- Business logic integration
- Security best practices

## üì± Usage Examples

### Organizing Documents
1. Download research paper, PRD, or code file
2. Drag into Soulfra Orchestrator
3. AI categorizes and extracts insights
4. File synced across all devices

### Querying Knowledge
1. Ask: "What's our competitive moat?"
2. AI searches complete knowledge base
3. Synthesizes answer from multiple docs
4. Provides sources and confidence level

### Building Features
1. Ask: "Generate trust scoring algorithm"
2. AI creates code based on your architecture
3. Includes business logic from PRDs
4. Follows your established patterns

## üîß Development

### Project Structure
```
src/
‚îú‚îÄ‚îÄ main.js                 # Electron main process
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ KnowledgeOrchestrator.js  # File processing
‚îÇ   ‚îú‚îÄ‚îÄ AIService.js             # AI integration
‚îÇ   ‚îî‚îÄ‚îÄ SyncService.js           # Google Drive sync
web/
‚îú‚îÄ‚îÄ index.html              # Frontend interface
‚îî‚îÄ‚îÄ assets/                 # Static assets
scripts/
‚îî‚îÄ‚îÄ setup.js               # Initial setup
```

### Building
```bash
npm run build     # Build distributable
npm run dev       # Development mode
```

## üöÄ Roadmap

### Phase 1: Core Platform ‚úÖ
- [x] File organization and categorization
- [x] AI knowledge base building
- [x] Basic query interface
- [x] Google Drive sync

### Phase 2: Intelligence Layer üöß
- [ ] Advanced relationship mapping
- [ ] Predictive insights
- [ ] Code generation improvements
- [ ] Mobile app

### Phase 3: Collaboration üìã
- [ ] Team sharing
- [ ] Real-time collaboration
- [ ] Enterprise features
- [ ] API for integrations

## ü§ù Contributing

1. Fork the repository
2. Create feature branch
3. Make changes
4. Test thoroughly
5. Submit pull request

## üìÑ License

MIT License - Use it to build your Soulfra empire!

## üÜò Support

- **Documentation**: Check this README and inline help
- **Issues**: Create GitHub issue with details
- **Questions**: Start a GitHub discussion

## üéâ Success Stories

*"Soulfra Orchestrator helped me organize 200+ docs and build features 5x faster with AI assistance. My trained AI knows my platform better than I do!"*

---

**Ready to become the Original Affiliate? Start organizing your knowledge and let AI accelerate your Soulfra development!**

üß† **Your AI advantage starts here.**
</script>

version: '3.8'

services:
  # Monitor Dashboard
  monitor:
    build:
      context: .
      dockerfile: Dockerfile.autonomous
    command: python3 FIXED_MONITOR.py
    ports:
      - "7777:7777"
    volumes:
      - ./logs:/app/logs
    restart: always
    
  # Chat Logger
  chat-logger:
    build:
      context: .
      dockerfile: Dockerfile.autonomous
    command: python3 CHAT_LOG_PROCESSOR.py
    ports:
      - "4040:4040"
    volumes:
      - ./logs:/app/logs
      - ./chatlog_drops:/app/chatlog_drops
    restart: always
    
  # Chat Processor
  chat-processor:
    build:
      context: .
      dockerfile: Dockerfile.autonomous
    command: python3 UNIFIED_CHATLOG_SYSTEM.py
    ports:
      - "8888:8888"
    volumes:
      - ./logs:/app/logs
      - ./processed_logs:/app/processed_logs
    restart: always
    
  # AI Ecosystem
  ai-ecosystem:
    build:
      context: .
      dockerfile: Dockerfile.autonomous
    command: python3 MINIMAL_AI_ECOSYSTEM.py
    ports:
      - "9999:9999"
    volumes:
      - ./logs:/app/logs
    restart: always
    
  # Max Autonomous
  max-autonomous:
    build:
      context: .
      dockerfile: Dockerfile.autonomous
    command: python3 SOULFRA_MAX_AUTONOMOUS.py
    ports:
      - "6004:6004"
    volumes:
      - ./logs:/app/logs
      - ./mobile_sync:/app/mobile_sync
      - ./qr_codes:/app/qr_codes
    restart: always
    
  # Simple Game
  game:
    build:
      context: .
      dockerfile: Dockerfile.autonomous
    command: python3 simple_game_5555.py
    ports:
      - "5555:5555"
    volumes:
      - ./logs:/app/logs
    restart: always
    
  # Working Platform
  platform:
    build:
      context: .
      dockerfile: Dockerfile.autonomous
    command: python3 WORKING_PLATFORM.py
    ports:
      - "3002:3002"
    volumes:
      - ./logs:/app/logs
    restart: always
    
  # Nginx reverse proxy
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx-autonomous.conf:/etc/nginx/nginx.conf
      - ./web_deployment:/usr/share/nginx/html
    depends_on:
      - monitor
      - chat-logger
      - chat-processor
      - ai-ecosystem
      - max-autonomous
    restart: always

volumes:
  logs:
  chatlog_drops:
  processed_logs:
  mobile_sync:
  qr_codes:
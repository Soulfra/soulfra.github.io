version: '3.8'

services:

  ultimate-platform:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.ultimate-platform
    ports:
      - "9999:9999"
    environment:
      - SOULFRA_SERVICE=Ultimate Platform
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/ultimate-platform:/data

  enterprise-platform:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.enterprise-platform
    ports:
      - "8080:8080"
    environment:
      - SOULFRA_SERVICE=Enterprise Platform
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/enterprise-platform:/data

  vibe-platform:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.vibe-platform
    ports:
      - "5555:5555"
    environment:
      - SOULFRA_SERVICE=Vibe Platform
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/vibe-platform:/data

  addiction-engine:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.addiction-engine
    ports:
      - "8086:8086"
    environment:
      - SOULFRA_SERVICE=Addiction Engine
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/addiction-engine:/data

  multiplayer-game:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.multiplayer-game
    ports:
      - "8765:8765"
    environment:
      - SOULFRA_SERVICE=Multiplayer Game
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/multiplayer-game:/data

  character-creator:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.character-creator
    ports:
      - "5000:5000"
    environment:
      - SOULFRA_SERVICE=Character Creator
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/character-creator:/data

  empathy-game:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.empathy-game
    ports:
      - "8087:8087"
    environment:
      - SOULFRA_SERVICE=Empathy Game
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/empathy-game:/data

  dev-debug-arena:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.dev-debug-arena
    ports:
      - "8001:8001"
    environment:
      - SOULFRA_SERVICE=Dev Debug Arena
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/dev-debug-arena:/data

  support-heroes-arena:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.support-heroes-arena
    ports:
      - "8002:8002"
    environment:
      - SOULFRA_SERVICE=Support Heroes Arena
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/support-heroes-arena:/data

  chat-processor:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.chat-processor
    ports:
      - "8090:8090"
    environment:
      - SOULFRA_SERVICE=Chat Processor
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/chat-processor:/data

  simple-chat:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.simple-chat
    ports:
      - "5555:5555"
    environment:
      - SOULFRA_SERVICE=Simple Chat
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/simple-chat:/data

  claude-bridge:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.claude-bridge
    ports:
      - "None:None"
    environment:
      - SOULFRA_SERVICE=Claude Bridge
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/claude-bridge:/data

  mirror-bridge:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.mirror-bridge
    ports:
      - "8700:8700"
    environment:
      - SOULFRA_SERVICE=Mirror Bridge
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/mirror-bridge:/data

  cal-domingo:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.cal-domingo
    ports:
      - "8080:8080"
    environment:
      - SOULFRA_SERVICE=Cal Domingo
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/cal-domingo:/data

  api-router:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.api-router
    ports:
      - "8080:8080"
    environment:
      - SOULFRA_SERVICE=API Router
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/api-router:/data

  platform-logger:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.platform-logger
    ports:
      - "None:None"
    environment:
      - SOULFRA_SERVICE=Platform Logger
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/platform-logger:/data

  real-monitoring:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.real-monitoring
    ports:
      - "None:None"
    environment:
      - SOULFRA_SERVICE=Real Monitoring
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/real-monitoring:/data

  ai-economy:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.ai-economy
    ports:
      - "None:None"
    environment:
      - SOULFRA_SERVICE=AI Economy
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/ai-economy:/data

  soulfra-backend:
    build:
      context: ../../../
      dockerfile: deployment/docker/Dockerfile.soulfra-backend
    ports:
      - "8080:8080"
    environment:
      - SOULFRA_SERVICE=Soulfra Backend
      - SOULFRA_ENV=production
    networks:
      - soulfra-network
    restart: unless-stopped
    volumes:
      - ./data/soulfra-backend:/data

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ../nginx/soulfra.conf:/etc/nginx/conf.d/default.conf
      - /etc/letsencrypt:/etc/letsencrypt:ro
      - static-data:/var/www/soulfra/static
    depends_on:
      - ultimate-platform
    networks:
      - soulfra-network
    restart: unless-stopped

  redis:
    image: redis:alpine
    volumes:
      - redis-data:/data
    networks:
      - soulfra-network
    restart: unless-stopped

  postgres:
    image: postgres:13
    environment:
      - POSTGRES_DB=soulfra
      - POSTGRES_USER=soulfra
      - POSTGRES_PASSWORD=soulfra_secure_password
    volumes:
      - postgres-data:/var/lib/postgresql/data
    networks:
      - soulfra-network
    restart: unless-stopped

networks:
  soulfra-network:
    driver: bridge

volumes:
  postgres-data:
  redis-data:
  static-data:

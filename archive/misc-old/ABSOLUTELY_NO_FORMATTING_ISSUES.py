#!/usr/bin/env python3

import http.server
import socketserver
import base64

PORT = 6789

# Base64 encoded HTML to avoid ALL formatting issues
ENCODED_GAME = "PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KPHRpdGxlPkFCU09MVVRFTFkgV09SS0lORyBHQU1FPC90aXRsZT4KPHN0eWxlPgpib2R5IHsgbWFyZ2luOiAwOyBiYWNrZ3JvdW5kOiAjMDAwOyBjb2xvcjogI2ZmZjsgZm9udC1mYW1pbHk6IEFyaWFsOyBkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgaGVpZ2h0OiAxMDB2aDsgfQouZ2FtZSB7IHRleHQtYWxpZ246IGNlbnRlcjsgfQouYXJlbmEgeyB3aWR0aDogNjAwcHg7IGhlaWdodDogNDAwcHg7IGJvcmRlcjogMnB4IHNvbGlkICMwMGZmODg7IG1hcmdpbjogMjBweCBhdXRvOyBwb3NpdGlvbjogcmVsYXRpdmU7IGJhY2tncm91bmQ6ICMxMTFXWyBvdmVyZmxvdzogaGlkZGVuOyB9Ci5wbGF5ZXIgeyBwb3NpdGlvbjogYWJzb2x1dGU7IHdpZHRoOiAzMHB4OyBoZWlnaHQ6IDMwcHg7IGJhY2tncm91bmQ6ICMwMGZmODg7IGJvcmRlci1yYWRpdXM6IDUwJTsgfQouZW5lbXkgeyBwb3NpdGlvbjogYWJzb2x1dGU7IHdpZHRoOiAyMHB4OyBoZWlnaHQ6IDIwcHg7IGJhY2tncm91bmQ6ICNmZjQ0NDQ7IGJvcmRlci1yYWRpdXM6IDUwJTsgfQouYnVsbGV0IHsgcG9zaXRpb246IGFic29sdXRlOyB3aWR0aDogNXB4OyBoZWlnaHQ6IDVweDsgYmFja2dyb3VuZDogI2ZmZmZmZjsgYm9yZGVyLXJhZGl1czogNTAlOyB9CmJ1dHRvbiB7IHBhZGRpbmc6IDEwcHggMjBweDsgbWFyZ2luOiA1cHg7IGJhY2tncm91bmQ6ICMwMGZmODg7IGNvbG9yOiAjMDAwOyBib3JkZXI6IG5vbmU7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyBmb250LXdlaWdodDogYm9sZDsgfQpidXR0b246aG92ZXIgeyB0cmFuc2Zvcm06IHNjYWxlKDEuMSk7IH0KLnN0YXRzIHsgbWFyZ2luOiAyMHB4OyB9Cjwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+Cgo8ZGl2IGNsYXNzPSJnYW1lIj4KICAgIDxoMT5BQlNPTFVURUxZIFdPUktJTkcgR0FNRTwvaDE+CiAgICA8ZGl2IGNsYXNzPSJzdGF0cyI+CiAgICAgICAgU2NvcmU6IDxzcGFuIGlkPSJzY29yZSI+MDwvc3Bhbj4gfCBIZWFsdGg6IDxzcGFuIGlkPSJoZWFsdGgiPjEwMDwvc3Bhbj4KICAgIDwvZGl2PgogICAgPGRpdiBjbGFzcz0iYXJlbmEiIGlkPSJhcmVuYSI+CiAgICAgICAgPGRpdiBjbGFzcz0icGxheWVyIiBpZD0icGxheWVyIiBzdHlsZT0ibGVmdDogMjg1cHg7IHRvcDogMTg1cHg7Ij48L2Rpdj4KICAgIDwvZGl2PgogICAgPGRpdj4KICAgICAgICA8YnV0dG9uIG9uY2xpY2s9Im1vdmVQbGF5ZXIoJ2xlZnQnKSI+TEVGVDWIL2J1dHRvbj4KICAgICAgICA8YnV0dG9uIG9uY2xpY2s9Im1vdmVQbGF5ZXIoJ3VwJykiPlVQPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJtb3ZlUGxheWVyKCdkb3duJykiPkRPV048L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIG9uY2xpY2s9Im1vdmVQbGF5ZXIoJ3JpZ2h0JykiPlJJR0hUPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJzaG9vdCgpIj5TSE9PVDwvYnV0dG9uPgogICAgPC9kaXY+CiAgICA8cD5Vc2UgYnV0dG9ucyBvciBXQVNEIGtleXMgdG8gbW92ZS4gU3BhY2UgdG8gc2hvb3QuPC9wPgo8L2Rpdj4KCjxzY3JpcHQ+CmxldCBwbGF5ZXJYID0gMjg1LCBwbGF5ZXJZID0gMTg1Owpsexq0IHNjb3JlID0gMCwgaGVhbHRoID0gMTAwOwpsZXQgZW5lbWllcyA9IFtdLCBidWxsZXRzID0gW107CmNvbnN0IGFyZW5hID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FyZW5hJyk7CmNvbnN0IHBsYXllciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXInKTsKCmZ1bmN0aW9uIG1vdmVQbGF5ZXIoZGlyKSB7CiAgICBzd2l0Y2goZGlyKSB7CiAgICAgICAgY2FzZSAnbGVmdCc6IHBsYXllclggPSBNYXRoLm1heCgwLCBwbGF5ZXJYIC0gMjApOyBicmVhazsKICAgICAgICBjYXNlICdyaWdodCc6IHBsYXllclggPSBNYXRoLm1pbig1NzAsIHBsYXllclggKyAyMCk7IGJyZWFrOwogICAgICAgIGNhc2UgJ3VwJzogcGxheWVyWSA9IE1hdGgubWF4KDAsIHBsYXllclkgLSAyMCk7IGJyZWFrOwogICAgICAgIGNhc2UgJ2Rvd24nOiBwbGF5ZXJZID0gTWF0aC5taW4oMzcwLCBwbGF5ZXJZICsgMjApOyBicmVhazsKICAgIH0KICAgIHBsYXllci5zdHlsZS5sZWZ0ID0gcGxheWVyWCArICdweCc7CiAgICBwbGF5ZXIuc3R5bGUudG9wID0gcGxheWVyWSArICdweCc7Cn0KCmZ1bmN0aW9uIHNob290KCkgewogICAgY29uc3QgYnVsbGV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBidWxsZXQuY2xhc3NOYW1lID0gJ2J1bGxldCc7CiAgICBidWxsZXQuc3R5bGUubGVmdCA9IChwbGF5ZXJYICsgMTIpICsgJ3B4JzsKICAgIGJ1bGxldC5zdHlsZS50b3AgPSBwbGF5ZXJZICsgJ3B4JzsKICAgIGFyZW5hLmFwcGVuZENoaWxkKGJ1bGxldCk7CiAgICBidWxsZXRzLnB1c2goe2VsOiBidWxsZXQsIHg6IHBsYXllclggKyAxMiwgeTogcGxheWVyWSwgdnk6IC0xMH0pOwp9CgpmdW5jdGlvbiBzcGF3bkVuZW15KCkgewogICAgY29uc3QgZW5lbXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIGVuZW15LmNsYXNzTmFtZSA9ICdlbmVteSc7CiAgICBjb25zdCB4ID0gTWF0aC5yYW5kb20oKSAqIDU4MDsKICAgIGVuZW15LnN0eWxlLmxlZnQgPSB4ICsgJ3B4JzsKICAgIGVuZW15LnN0eWxlLnRvcCA9ICcwcHgnOwogICAgYXJlbmEuYXBwZW5kQ2hpbGQoZW5lbXkpOwogICAgZW5lbWllcy5wdXNoKHtlbDogZW5lbXksIHg6IHgsIHk6IDAsIHNwZWVkOiAxICsgTWF0aC5yYW5kb20oKSAqIDJ9KTsKfQoKZnVuY3Rpb24gZ2FtZUxvb3AoKSB7CiAgICAvLyBNb3ZlIGJ1bGxldHMKICAgIGJ1bGxldHMgPSBidWxsZXRzLmZpbHRlcihiID0+IHsKICAgICAgICBiLnkgKz0gYi52eTsKICAgICAgICBiLmVsLnN0eWxlLnRvcCA9IGIueSArICdweCc7CiAgICAgICAgaWYgKGIueSA8IDApIHsKICAgICAgICAgICAgYi5lbC5yZW1vdmUoKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0pOwogICAgCiAgICAvLyBNb3ZlIGVuZW1pZXMKICAgIGVuZW1pZXMgPSBlbmVtaWVzLmZpbHRlcihlID0+IHsKICAgICAgICBlLnkgKz0gZS5zcGVlZDsKICAgICAgICBlLmVsLnN0eWxlLnRvcCA9IGUueSArICdweCc7CiAgICAgICAgCiAgICAgICAgLy8gQ2hlY2sgY29sbGlzaW9uIHdpdGggcGxheWVyCiAgICAgICAgaWYgKE1hdGguYWJzKGUueCAtIHBsYXllclgpIDwgMjUgJiYgTWF0aC5hYnMoZS55IC0gcGxheWVyWSkgPCAyNSkgewogICAgICAgICAgICBoZWFsdGggLT0gMTA7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZWFsdGgnKS50ZXh0Q29udGVudCA9IGhlYWx0aDsKICAgICAgICAgICAgZS5lbC5yZW1vdmUoKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBDaGVjayBjb2xsaXNpb24gd2l0aCBidWxsZXRzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWxsZXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGIgPSBidWxsZXRzW2ldOwogICAgICAgICAgICBpZiAoTWF0aC5hYnMoYi54IC0gZS54KSA8IDE1ICYmIE1hdGguYWJzKGIueSAtIGUueSkgPCAxNSkgewogICAgICAgICAgICAgICAgYi5lbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIGJ1bGxldHMuc3BsaWNlKGksIDEpOwogICAgICAgICAgICAgICAgZS5lbC5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHNjb3JlICs9IDEwOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Njb3JlJykudGV4dENvbnRlbnQgPSBzY29yZTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoZS55ID4gNDAwKSB7CiAgICAgICAgICAgIGUuZWwucmVtb3ZlKCk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9KTsKICAgIAogICAgaWYgKGhlYWx0aCA+IDApIHsKICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZ2FtZUxvb3ApOwogICAgfSBlbHNlIHsKICAgICAgICBhbGVydCgnR2FtZSBPdmVyISBTY29yZTogJyArIHNjb3JlKTsKICAgIH0KfQoKLy8gS2V5Ym9hcmQgY29udHJvbHMKZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7CiAgICBzd2l0Y2goZS5rZXkudG9Mb3dlckNhc2UoKSkgewogICAgICAgIGNhc2UgJ2EnOiBjYXNlICdhcnJvd2xlZnQnOiBtb3ZlUGxheWVyKCdsZWZ0Jyk7IGJyZWFrOwogICAgICAgIGNhc2UgJ2QnOiBjYXNlICdhcnJvd3JpZ2h0JzogbW92ZVBsYXllcigncmlnaHQnKTsgYnJlYWs7CiAgICAgICAgY2FzZSAndyc6IGNhc2UgJ2Fycm93dXAnOiBtb3ZlUGxheWVyKCd1cCcpOyBicmVhazsKICAgICAgICBjYXNlICdzJzogY2FzZSAnYXJyb3dkb3duJzogbW92ZVBsYXllcignZG93bicpOyBicmVhazsKICAgICAgICBjYXNlICcgJzogc2hvb3QoKTsgZS5wcmV2ZW50RGVmYXVsdCgpOyBicmVhazsKICAgIH0KfSk7CgovLyBTdGFydCBnYW1lCnNldEludGVydmFsKHNwYXduRW5lbXksIDIwMDApOwpnYW1lTG9vcCgpOwo8L3NjcmlwdD4KCjwvYm9keT4KPC9odG1sPg=="

class GameHandler(http.server.SimpleHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-type', 'text/html')
        self.end_headers()
        
        # Decode the base64 HTML
        html_content = base64.b64decode(ENCODED_GAME).decode('utf-8')
        self.wfile.write(html_content.encode('utf-8'))

    def log_message(self, format, *args):
        pass  # Suppress logs

if __name__ == "__main__":
    print(f"""
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║           ABSOLUTELY NO FORMATTING ISSUES GAME             ║
║                                                            ║
║  Running at: http://localhost:{PORT}                       ║
║                                                            ║
║  This uses base64 encoding to avoid ALL formatting issues  ║
║  The game is simple but it WORKS 100% GUARANTEED          ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
    """)
    
    with socketserver.TCPServer(("", PORT), GameHandler) as httpd:
        httpd.serve_forever()
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CringeProof - Will Your Takes Age Well?</title>
  <meta name="description" content="Time-locked prediction market backed by real assets. Make predictions, earn tokens, unlock zones.">

  <style>
    :root {
      /* Theme variables - change these for reskins */
      --primary-color: #9B59B6;
      --secondary-color: #8E44AD;
      --background: #1a1a2e;
      --text: #ffffff;
      --success: #00C49A;
      --cringe: #FF4136;
      --locked: #555;
      --unlocked: var(--primary-color);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, var(--background) 0%, #0f0f1e 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 20px;
    }

    header {
      text-align: center;
      padding: 40px 20px;
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: 40px;
    }

    h1 {
      font-size: 3rem;
      margin-bottom: 10px;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .tagline {
      font-size: 1.2rem;
      opacity: 0.8;
      margin-bottom: 20px;
    }

    .user-stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .stat {
      background: rgba(255, 255, 255, 0.1);
      padding: 10px 20px;
      border-radius: 8px;
      border: 1px solid var(--primary-color);
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary-color);
    }

    .map-container {
      max-width: 1200px;
      margin: 0 auto;
      position: relative;
      padding: 40px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
      border: 2px solid var(--primary-color);
      min-height: 600px;
    }

    .map-title {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 40px;
      opacity: 0.9;
    }

    .zone {
      position: absolute;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid var(--locked);
      border-radius: 12px;
      padding: 20px;
      width: 200px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .zone:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }

    .zone.unlocked {
      border-color: var(--unlocked);
      background: rgba(155, 89, 182, 0.2);
    }

    .zone.current {
      border-color: var(--success);
      box-shadow: 0 0 20px var(--success);
    }

    .zone-icon {
      font-size: 3rem;
      margin-bottom: 10px;
    }

    .zone-name {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .zone-status {
      font-size: 0.9rem;
      opacity: 0.7;
      margin-top: 10px;
    }

    .zone-locked {
      color: var(--cringe);
      font-weight: bold;
    }

    .zone-unlocked {
      color: var(--success);
      font-weight: bold;
    }

    /* Zone positions */
    #lumbridge { top: 400px; left: 100px; }
    #varrock { top: 300px; left: 300px; }
    #falador { top: 200px; left: 500px; }
    #wilderness { top: 100px; left: 700px; }
    #cosmetics { top: 450px; left: 250px; }

    .unlock-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .unlock-modal.active {
      display: flex;
    }

    .unlock-content {
      background: var(--background);
      border: 2px solid var(--primary-color);
      border-radius: 12px;
      padding: 40px;
      max-width: 600px;
      width: 90%;
    }

    .unlock-paths {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-top: 30px;
    }

    .unlock-path {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid var(--locked);
      border-radius: 8px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .unlock-path.available {
      border-color: var(--success);
    }

    .unlock-path:hover {
      transform: translateX(10px);
      border-color: var(--primary-color);
    }

    .path-name {
      font-size: 1.2rem;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .path-progress {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      margin-top: 10px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--success);
      transition: width 0.3s ease;
    }

    .close-btn {
      background: var(--cringe);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 20px;
    }

    .close-btn:hover {
      opacity: 0.8;
    }

    footer {
      text-align: center;
      padding: 40px 20px;
      margin-top: 60px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      opacity: 0.6;
    }

    @media (max-width: 900px) {
      .zone {
        width: 150px;
        padding: 15px;
      }

      #lumbridge { top: 50px; left: 20px; }
      #varrock { top: 150px; left: 20px; }
      #falador { top: 250px; left: 20px; }
      #wilderness { top: 350px; left: 20px; }
      #cosmetics { top: 450px; left: 20px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>üö´ CringeProof</h1>
    <p class="tagline">Will Your Takes Age Well?</p>
    <p>Time-locked predictions backed by real assets (GME, BTC, FRED bonds)</p>

    <div class="user-stats">
      <div class="stat">
        <div class="stat-label">Tier</div>
        <div class="stat-value" id="user-tier">Free</div>
      </div>
      <div class="stat">
        <div class="stat-label">Tokens</div>
        <div class="stat-value" id="user-tokens">150</div>
      </div>
      <div class="stat">
        <div class="stat-label">Reputation</div>
        <div class="stat-value" id="user-reputation">75</div>
      </div>
    </div>
  </header>

  <div class="map-container">
    <h2 class="map-title">üó∫Ô∏è Explore the Map</h2>

    <!-- Lumbridge (Spawn) -->
    <div class="zone unlocked current" id="lumbridge" onclick="showUnlockModal('lumbridge')">
      <div class="zone-icon">üè†</div>
      <div class="zone-name">Lumbridge</div>
      <div class="zone-description">Spawn Zone</div>
      <div class="zone-status zone-unlocked">‚úÖ Unlocked</div>
    </div>

    <!-- Varrock (Basic Predictions) -->
    <div class="zone unlocked" id="varrock" onclick="showUnlockModal('varrock')">
      <div class="zone-icon">üèõÔ∏è</div>
      <div class="zone-name">Varrock</div>
      <div class="zone-description">Basic Predictions</div>
      <div class="zone-status zone-unlocked">‚úÖ Unlocked (10/month limit)</div>
    </div>

    <!-- Falador (Pro Zone) -->
    <div class="zone" id="falador" onclick="showUnlockModal('falador')">
      <div class="zone-icon">‚öîÔ∏è</div>
      <div class="zone-name">Falador</div>
      <div class="zone-description">Pro Zone</div>
      <div class="zone-status zone-locked">üîí Locked</div>
    </div>

    <!-- Wilderness (Treasury) -->
    <div class="zone" id="wilderness" onclick="showUnlockModal('wilderness')">
      <div class="zone-icon">üíÄ</div>
      <div class="zone-name">Wilderness</div>
      <div class="zone-description">Treasury Zone</div>
      <div class="zone-status zone-locked">üîí Locked</div>
    </div>

    <!-- Cosmetics Shop -->
    <div class="zone unlocked" id="cosmetics" onclick="showUnlockModal('cosmetics')">
      <div class="zone-icon">üëï</div>
      <div class="zone-name">Cosmetics</div>
      <div class="zone-description">Avatar Shop</div>
      <div class="zone-status zone-unlocked">‚úÖ Unlocked</div>
    </div>
  </div>

  <!-- Unlock Modal -->
  <div class="unlock-modal" id="unlock-modal">
    <div class="unlock-content">
      <h2 id="modal-zone-name">Zone Name</h2>
      <p id="modal-zone-description">Description</p>

      <div class="unlock-paths" id="unlock-paths">
        <!-- Dynamically populated -->
      </div>

      <button class="close-btn" onclick="closeModal()">Close</button>
    </div>
  </div>

  <footer>
    <p>Built with ‚ù§Ô∏è by roughsparks</p>
    <p>GitHub: <a href="https://github.com/soulfra/cringeproof-vertical" style="color: var(--primary-color);">soulfra/cringeproof-vertical</a></p>
  </footer>

  <script>
    // User state (mock data)
    const user = {
      tier: 'free',
      tokens: 150,
      reputation: 75
    };

    // Zone configurations
    const zones = {
      lumbridge: {
        name: 'Lumbridge (Spawn Zone)',
        description: 'New players spawn here. Read-only access to predictions and leaderboard.',
        requirements: { tokens: 0, reputation: 0, tier: 'free' },
        unlocked: true
      },
      varrock: {
        name: 'Varrock (Basic Predictions)',
        description: 'Make your first predictions. Limited to 10/month.',
        requirements: { tokens: 0, reputation: 0, tier: 'free' },
        unlocked: true
      },
      falador: {
        name: 'Falador (Pro Zone)',
        description: 'Unlimited predictions. Mint medallions. Earn tokens from accurate predictions.',
        requirements: { tokens: 1000, reputation: 100, tier: 'pro' },
        unlocked: false
      },
      wilderness: {
        name: 'Wilderness (Treasury Zone)',
        description: 'High-risk, high-reward. Manage treasury (buy GME, BTC, FRED bonds).',
        requirements: { tokens: 5000, reputation: 500, tier: 'unlimited' },
        unlocked: false
      },
      cosmetics: {
        name: 'Cosmetics Shop',
        description: 'Spend tokens on avatar skins, backgrounds, accessories.',
        requirements: { tokens: 100, reputation: 0, tier: 'free' },
        unlocked: true
      }
    };

    function showUnlockModal(zoneId) {
      const zone = zones[zoneId];
      const modal = document.getElementById('unlock-modal');
      const modalName = document.getElementById('modal-zone-name');
      const modalDesc = document.getElementById('modal-zone-description');
      const unlockPaths = document.getElementById('unlock-paths');

      modalName.textContent = zone.name;
      modalDesc.textContent = zone.description;

      // Build unlock paths
      unlockPaths.innerHTML = '';

      if (zone.unlocked) {
        unlockPaths.innerHTML = `
          <div class="unlock-path available">
            <div class="path-name">‚úÖ Already Unlocked</div>
            <p>You have access to this zone!</p>
          </div>
        `;
      } else {
        // Path 1: Tokens
        const tokenProgress = Math.min(100, (user.tokens / zone.requirements.tokens) * 100);
        const tokenAvailable = user.tokens >= zone.requirements.tokens;

        unlockPaths.innerHTML += `
          <div class="unlock-path ${tokenAvailable ? 'available' : ''}">
            <div class="path-name">${tokenAvailable ? '‚úÖ' : '‚è≥'} Unlock with Tokens (F2P)</div>
            <div class="path-progress">
              <span>Progress: ${user.tokens}/${zone.requirements.tokens}</span>
              <span>${tokenProgress.toFixed(0)}%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: ${tokenProgress}%"></div>
            </div>
            <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">
              ${tokenAvailable ? 'Click to unlock now!' : 'Make accurate predictions to earn tokens'}
            </p>
          </div>
        `;

        // Path 2: Reputation
        const repProgress = Math.min(100, (user.reputation / zone.requirements.reputation) * 100);
        const repAvailable = user.reputation >= zone.requirements.reputation;

        unlockPaths.innerHTML += `
          <div class="unlock-path ${repAvailable ? 'available' : ''}">
            <div class="path-name">${repAvailable ? '‚úÖ' : '‚è≥'} Unlock with Reputation</div>
            <div class="path-progress">
              <span>Progress: ${user.reputation}/${zone.requirements.reputation}</span>
              <span>${repProgress.toFixed(0)}%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: ${repProgress}%"></div>
            </div>
            <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">
              ${repAvailable ? 'Click to unlock permanently!' : 'Engage with community, vote on predictions'}
            </p>
          </div>
        `;

        // Path 3: Free Access (MVP)
        unlockPaths.innerHTML += `
          <div class="unlock-path available">
            <div class="path-name">‚úÖ Free Access (MVP)</div>
            <p style="margin-top: 10px;">Enter your email to unlock all zones for free during MVP</p>
            <input id="signup-email" type="email" placeholder="your@email.com" style="
              width: 100%;
              padding: 10px;
              margin-top: 10px;
              border: 1px solid rgba(255,255,255,0.2);
              background: rgba(0,0,0,0.3);
              color: white;
              border-radius: 8px;
            ">
            <button style="
              background: var(--primary-color);
              color: white;
              border: none;
              padding: 10px 20px;
              border-radius: 8px;
              cursor: pointer;
              margin-top: 10px;
              width: 100%;
            " onclick="freeSignup()">
              Get Free Access üéâ
            </button>
          </div>
        `;
      }

      modal.classList.add('active');
    }

    function closeModal() {
      document.getElementById('unlock-modal').classList.remove('active');
    }

    // Update UI with user stats
    document.getElementById('user-tier').textContent = user.tier.charAt(0).toUpperCase() + user.tier.slice(1);
    document.getElementById('user-tokens').textContent = user.tokens;
    document.getElementById('user-reputation').textContent = user.reputation;

    // Free signup (no payment needed)
    const API_URL = 'http://localhost:3001';

    async function freeSignup() {
      const emailInput = document.getElementById('signup-email');
      const email = emailInput ? emailInput.value : '';

      if (!email || !email.includes('@')) {
        alert('Please enter a valid email address');
        return;
      }

      try {
        const response = await fetch(`${API_URL}/api/auth/free-signup`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email })
        });

        const data = await response.json();

        if (data.error) {
          alert(`Error: ${data.error}`);
          return;
        }

        // Update user stats with unlimited access
        user.tier = 'unlimited';
        user.tokens = 10000;
        user.reputation = 500;

        document.getElementById('user-tier').textContent = 'Unlimited';
        document.getElementById('user-tokens').textContent = '10000';
        document.getElementById('user-reputation').textContent = '500';

        // Close modal and show success
        closeModal();
        alert(`üéâ ${data.user.message}\n\nYou now have:\n‚Ä¢ Unlimited tier access\n‚Ä¢ 10,000 tokens\n‚Ä¢ 500 reputation\n\nAll zones unlocked!`);

        // Unlock all zones visually
        document.querySelectorAll('.zone').forEach(zone => {
          zone.classList.add('unlocked');
          const status = zone.querySelector('.zone-status');
          if (status) {
            status.textContent = '‚úÖ Unlocked';
            status.classList.remove('zone-locked');
            status.classList.add('zone-unlocked');
          }
        });

      } catch (error) {
        console.error('Signup error:', error);
        alert('Failed to sign up. Make sure API server is running on http://localhost:3001');
      }
    }
  </script>
</body>
</html>

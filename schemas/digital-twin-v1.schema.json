{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://soulfra.com/schemas/digital-twin-v1.schema.json",
  "title": "Soulfra Digital Twin Format",
  "description": "Complete digital twin metadata schema including visual, audio, behavioral, and rigging data for AI UGC and metaverse applications",
  "version": "1.0.0",
  "type": "object",
  "required": ["version", "timestamp", "visual"],
  "properties": {
    "version": {
      "type": "string",
      "const": "1.0",
      "description": "Schema version"
    },
    "content_type": {
      "type": "string",
      "const": "application/vnd.soulfra.digital-twin+json",
      "description": "MIME type for Soulfra Digital Twin format"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of creation"
    },
    "source_identity": {
      "type": "object",
      "description": "Identity information for consent and provenance",
      "properties": {
        "name": { "type": "string" },
        "consent_given": { "type": "boolean" },
        "consent_date": { "type": "string", "format": "date-time" },
        "usage_rights": {
          "type": "string",
          "enum": ["personal", "commercial", "non-commercial", "unrestricted"]
        },
        "watermark_enabled": { "type": "boolean" }
      }
    },
    "visual": {
      "type": "object",
      "required": ["source_images", "colors", "depth_maps"],
      "description": "Visual appearance data including images, colors, and depth information",
      "properties": {
        "source_images": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "filename": { "type": "string" },
              "resolution": {
                "type": "object",
                "properties": {
                  "width": { "type": "integer" },
                  "height": { "type": "integer" }
                }
              },
              "format": { "type": "string" },
              "purpose": {
                "type": "string",
                "enum": ["profile", "banner", "full_body", "close_up", "reference"]
              },
              "data_url": {
                "type": "string",
                "pattern": "^data:image/"
              }
            }
          }
        },
        "llava_description": {
          "type": "string",
          "description": "AI-generated description from LLaVA vision model"
        },
        "colors": {
          "type": "object",
          "required": ["dominant", "palette", "detailed"],
          "properties": {
            "dominant": {
              "type": "string",
              "pattern": "^#[0-9A-Fa-f]{6}$"
            },
            "palette": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "^#[0-9A-Fa-f]{6}$"
              }
            },
            "detailed": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "hex": { "type": "string", "pattern": "^#[0-9A-Fa-f]{6}$" },
                  "rgb": {
                    "type": "object",
                    "properties": {
                      "r": { "type": "integer", "minimum": 0, "maximum": 255 },
                      "g": { "type": "integer", "minimum": 0, "maximum": 255 },
                      "b": { "type": "integer", "minimum": 0, "maximum": 255 }
                    }
                  },
                  "percentage": { "type": "number" },
                  "name": { "type": "string" }
                }
              }
            },
            "stats": {
              "type": "object",
              "properties": {
                "unique_colors": { "type": "integer" },
                "total_pixels": { "type": "integer" },
                "interesting_pixels": { "type": "integer" }
              }
            }
          }
        },
        "depth_maps": {
          "type": "object",
          "required": ["method", "depth_range", "resolution", "visualizations"],
          "properties": {
            "method": { "type": "string" },
            "depth_range": {
              "type": "object",
              "properties": {
                "min": { "type": "number" },
                "max": { "type": "number" },
                "mean": { "type": "number" },
                "std": { "type": "number" }
              }
            },
            "resolution": {
              "type": "object",
              "properties": {
                "width": { "type": "integer" },
                "height": { "type": "integer" }
              }
            },
            "visualizations": {
              "type": "object",
              "properties": {
                "colored": {
                  "type": "string",
                  "pattern": "^data:image/png;base64,"
                },
                "grayscale": {
                  "type": "string",
                  "pattern": "^data:image/png;base64,"
                },
                "grid_beadmap": {
                  "type": "string",
                  "pattern": "^data:image/png;base64,",
                  "description": "20px grid with variable-sized beads (2-4px) indicating depth"
                }
              }
            },
            "note": { "type": "string" }
          }
        },
        "face_landmarks": {
          "type": "object",
          "description": "MediaPipe face mesh landmarks (468 points)",
          "properties": {
            "landmarks": {
              "type": "array",
              "minItems": 468,
              "maxItems": 468,
              "items": {
                "type": "object",
                "properties": {
                  "x": { "type": "number" },
                  "y": { "type": "number" },
                  "z": { "type": "number" }
                }
              }
            },
            "confidence": { "type": "number", "minimum": 0, "maximum": 1 }
          }
        }
      }
    },
    "audio": {
      "type": "object",
      "description": "Voice and audio characteristics",
      "properties": {
        "voice_samples": {
          "type": "array",
          "description": "Audio samples for voice cloning (min 6 seconds)",
          "items": {
            "type": "object",
            "properties": {
              "filename": { "type": "string" },
              "duration_seconds": { "type": "number", "minimum": 6 },
              "sample_rate": { "type": "integer" },
              "format": { "type": "string", "enum": ["wav", "mp3", "flac"] },
              "data_url": {
                "type": "string",
                "pattern": "^data:audio/"
              }
            }
          }
        },
        "voice_characteristics": {
          "type": "object",
          "description": "Analyzed voice features",
          "properties": {
            "pitch_mean_hz": { "type": "number" },
            "pitch_std_hz": { "type": "number" },
            "pitch_range": {
              "type": "object",
              "properties": {
                "min_hz": { "type": "number" },
                "max_hz": { "type": "number" }
              }
            },
            "speaking_rate_wpm": { "type": "number" },
            "tone": {
              "type": "string",
              "enum": ["conversational", "formal", "energetic", "calm", "monotone"]
            },
            "accent": { "type": "string" },
            "gender": {
              "type": "string",
              "enum": ["male", "female", "neutral", "unknown"]
            },
            "age_range": { "type": "string" }
          }
        },
        "xtts_model": {
          "type": "object",
          "description": "XTTS-v2 voice cloning model data",
          "properties": {
            "model_version": { "type": "string" },
            "trained_languages": {
              "type": "array",
              "items": { "type": "string" }
            },
            "model_path": { "type": "string" },
            "latency_ms": { "type": "number" }
          }
        }
      }
    },
    "behavioral": {
      "type": "object",
      "description": "Behavioral patterns and personality traits",
      "properties": {
        "mannerisms": {
          "type": "array",
          "items": { "type": "string" }
        },
        "speech_patterns": {
          "type": "object",
          "properties": {
            "common_phrases": { "type": "array", "items": { "type": "string" } },
            "filler_words": { "type": "array", "items": { "type": "string" } },
            "pause_frequency": { "type": "number" },
            "sentence_complexity": { "type": "string" }
          }
        },
        "personality_traits": {
          "type": "object",
          "properties": {
            "big_five": {
              "type": "object",
              "properties": {
                "openness": { "type": "number", "minimum": 0, "maximum": 100 },
                "conscientiousness": { "type": "number", "minimum": 0, "maximum": 100 },
                "extraversion": { "type": "number", "minimum": 0, "maximum": 100 },
                "agreeableness": { "type": "number", "minimum": 0, "maximum": 100 },
                "neuroticism": { "type": "number", "minimum": 0, "maximum": 100 }
              }
            }
          }
        }
      }
    },
    "rigging": {
      "type": "object",
      "description": "3D rigging and animation data",
      "properties": {
        "blender_compatible": { "type": "boolean" },
        "rigify_armature": {
          "type": "object",
          "properties": {
            "rig_type": { "type": "string" },
            "bone_count": { "type": "integer" },
            "ik_chains": { "type": "array", "items": { "type": "string" } }
          }
        },
        "vrm_export": {
          "type": "object",
          "description": "VRM format export for VTuber and metaverse",
          "properties": {
            "version": { "type": "string" },
            "data_url": { "type": "string", "pattern": "^data:model/gltf" },
            "expressions": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "gltf_export": {
          "type": "object",
          "description": "glTF 2.0 export with rigging extensions",
          "properties": {
            "version": { "type": "string", "const": "2.0" },
            "data_url": { "type": "string", "pattern": "^data:model/gltf" }
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "required": ["tool", "version"],
      "properties": {
        "tool": { "type": "string" },
        "version": { "type": "string" },
        "analyzed_at": { "type": "string", "format": "date-time" },
        "compliance": {
          "type": "object",
          "properties": {
            "eu_ai_act": { "type": "boolean" },
            "elvis_act_tn": { "type": "boolean" },
            "no_fakes_act": { "type": "boolean" },
            "watermarked": { "type": "boolean" }
          }
        },
        "provenance": {
          "type": "object",
          "properties": {
            "creator": { "type": "string" },
            "creation_method": { "type": "string" },
            "ai_generated_percentage": { "type": "number", "minimum": 0, "maximum": 100 }
          }
        }
      }
    }
  }
}

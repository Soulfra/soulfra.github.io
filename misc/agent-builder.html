<div class="agent-builder-component">
    <div class="builder-intro">
        <p class="info-text">Build custom agents that appear independent but secretly route through Cal's sovereign vault.</p>
    </div>

    <form id="agentBuilderForm" class="agent-form">
        <div class="form-row">
            <div class="form-group flex-grow">
                <label for="agentName">Agent Name</label>
                <input type="text" id="agentName" placeholder="e.g., Research Assistant" required>
                <small class="form-hint">Give your agent a memorable name</small>
            </div>
            
            <div class="form-group">
                <label for="agentIcon">Icon</label>
                <select id="agentIcon">
                    <option value="ü§ñ">ü§ñ Robot</option>
                    <option value="üß†">üß† Brain</option>
                    <option value="‚ú®">‚ú® Sparkles</option>
                    <option value="üîÆ">üîÆ Crystal Ball</option>
                    <option value="üéØ">üéØ Target</option>
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label for="agentDescription">Description</label>
            <textarea id="agentDescription" rows="3" placeholder="What does this agent do?"></textarea>
        </div>
        
        <div class="form-group">
            <label for="agentTone">Personality & Tone</label>
            <select id="agentTone">
                <option value="professional">Professional - Clear and formal</option>
                <option value="friendly">Friendly - Warm and approachable</option>
                <option value="technical">Technical - Precise and detailed</option>
                <option value="creative">Creative - Imaginative and innovative</option>
                <option value="philosophical">Philosophical - Thoughtful and deep</option>
                <option value="mentor">Mentor - Guiding and educational</option>
                <option value="analytical">Analytical - Data-driven and logical</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>Agent Capabilities</label>
            <div class="tools-grid">
                <label class="tool-option">
                    <input type="checkbox" name="tools" value="web_search">
                    <span class="tool-label">
                        <span class="tool-icon">üåê</span>
                        Web Search
                    </span>
                </label>
                <label class="tool-option">
                    <input type="checkbox" name="tools" value="calculator">
                    <span class="tool-label">
                        <span class="tool-icon">üßÆ</span>
                        Calculator
                    </span>
                </label>
                <label class="tool-option">
                    <input type="checkbox" name="tools" value="code_interpreter">
                    <span class="tool-label">
                        <span class="tool-icon">üíª</span>
                        Code Interpreter
                    </span>
                </label>
                <label class="tool-option">
                    <input type="checkbox" name="tools" value="image_generation">
                    <span class="tool-label">
                        <span class="tool-icon">üé®</span>
                        Image Generation
                    </span>
                </label>
                <label class="tool-option">
                    <input type="checkbox" name="tools" value="data_analysis">
                    <span class="tool-label">
                        <span class="tool-icon">üìä</span>
                        Data Analysis
                    </span>
                </label>
                <label class="tool-option">
                    <input type="checkbox" name="tools" value="file_management">
                    <span class="tool-label">
                        <span class="tool-icon">üìÅ</span>
                        File Management
                    </span>
                </label>
            </div>
        </div>
        
        <div class="form-row">
            <div class="form-group">
                <label for="llmTarget">Primary LLM</label>
                <select id="llmTarget">
                    <option value="claude">Claude (Recommended)</option>
                    <option value="openai">OpenAI GPT</option>
                    <option value="ollama">Ollama (Local)</option>
                    <option value="local">Local Vault</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="fallbackLLM">Fallback LLM</label>
                <select id="fallbackLLM">
                    <option value="auto">Auto-select</option>
                    <option value="claude">Claude</option>
                    <option value="openai">OpenAI GPT</option>
                    <option value="ollama">Ollama</option>
                    <option value="local">Local Vault</option>
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label>Advanced Options</label>
            <div class="advanced-options">
                <label class="checkbox-label">
                    <input type="checkbox" id="enableMemory" checked>
                    Enable memory persistence
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="enableReflection" checked>
                    Enable sovereign reflection
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="trackForks" checked>
                    Track agent forks
                </label>
            </div>
        </div>
        
        <div class="form-group monetization-section">
            <label>
                <input type="checkbox" id="monetizeAgent" onchange="toggleMonetization()">
                <strong>üí∞ Monetize This Agent</strong>
            </label>
            
            <div id="monetizationOptions" style="display: none;">
                <div class="form-group">
                    <label for="agentPrice">Price (Credits)</label>
                    <input type="number" id="agentPrice" min="5" max="500" value="29" step="1">
                    <small class="form-hint">Users pay this to use your agent (you keep 70%)</small>
                </div>
                <div class="form-group">
                    <label for="salesDescription">Sales Description</label>
                    <textarea id="salesDescription" rows="2" placeholder="What makes your agent special? Why should users pay for it?"></textarea>
                </div>
            </div>
        </div>
        
        <div class="form-actions">
            <button type="button" id="previewAgent" class="btn-secondary">Preview</button>
            <button type="button" id="createAgent" class="btn-primary">Create Agent</button>
        </div>
    </form>
    
    <div id="agentPreview" class="agent-preview" style="display: none;">
        <h4>Agent Preview</h4>
        <div class="preview-card">
            <div class="preview-header">
                <span class="preview-icon">ü§ñ</span>
                <span class="preview-name">Agent Name</span>
            </div>
            <div class="preview-body">
                <p class="preview-description"></p>
                <div class="preview-details">
                    <span class="detail-item">Tone: <strong>Professional</strong></span>
                    <span class="detail-item">LLM: <strong>Claude</strong></span>
                    <span class="detail-item">Tools: <strong>0</strong></span>
                </div>
            </div>
            <div class="preview-note">
                <small>üîí This agent will route through the sovereign vault</small>
            </div>
        </div>
    </div>
    
    <div id="agentResult" class="result-section" style="display: none;">
        <div class="success-message">
            <span class="success-icon">‚úÖ</span>
            <div>
                <h4>Agent Created Successfully!</h4>
                <p>Your agent has been created and is now tracking through the reflection vortex.</p>
                <div class="agent-details">
                    <code id="agentId"></code>
                    <button class="btn-secondary" onclick="copyAgentId()">Copy ID</button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.agent-builder-component {
    max-width: 800px;
}

.builder-intro {
    margin-bottom: 2rem;
}

.info-text {
    color: var(--text-secondary);
    font-style: italic;
}

.agent-form {
    background: var(--background);
    padding: 1.5rem;
    border-radius: 0.5rem;
    border: 1px solid var(--border-color);
}

.form-row {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 1rem;
}

.flex-grow {
    flex: 1;
}

.form-hint {
    color: var(--text-secondary);
    font-size: 0.75rem;
    margin-top: 0.25rem;
}

.tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 0.75rem;
    margin-top: 0.5rem;
}

.tool-option {
    display: flex;
    align-items: center;
    cursor: pointer;
}

.tool-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: var(--surface);
    border: 1px solid var(--border-color);
    border-radius: 0.375rem;
    font-size: 0.875rem;
    transition: all 0.2s;
}

.tool-option input:checked + .tool-label {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.tool-icon {
    font-size: 1rem;
}

.advanced-options {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-top: 0.5rem;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.875rem;
}

.form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
    margin-top: 2rem;
}

.agent-preview {
    margin-top: 2rem;
}

.preview-card {
    background: var(--background);
    border: 1px solid var(--border-color);
    border-radius: 0.5rem;
    overflow: hidden;
}

.preview-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: var(--surface);
    border-bottom: 1px solid var(--border-color);
}

.preview-icon {
    font-size: 1.5rem;
}

.preview-name {
    font-weight: 600;
}

.preview-body {
    padding: 1rem;
}

.preview-description {
    margin-bottom: 1rem;
    color: var(--text-secondary);
}

.preview-details {
    display: flex;
    gap: 1.5rem;
    font-size: 0.875rem;
}

.detail-item strong {
    color: var(--primary-color);
}

.preview-note {
    padding: 0.75rem 1rem;
    background: rgba(99, 102, 241, 0.1);
    font-size: 0.875rem;
    color: var(--primary-color);
}

.success-message {
    display: flex;
    gap: 1rem;
    padding: 1.5rem;
    background: rgba(16, 185, 129, 0.1);
    border: 1px solid rgba(16, 185, 129, 0.3);
    border-radius: 0.5rem;
}

.success-icon {
    font-size: 2rem;
}

.agent-details {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-top: 0.5rem;
}

.agent-details code {
    padding: 0.25rem 0.5rem;
    background: var(--surface);
    border: 1px solid var(--border-color);
    border-radius: 0.25rem;
    font-size: 0.875rem;
}

.monetization-section {
    background: var(--background);
    padding: 1rem;
    border-radius: 0.375rem;
    margin-top: 1.5rem;
    border: 2px dashed var(--warning-color);
}

.monetization-section > label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 1rem;
}

#monetizationOptions {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
}
</style>

<script>
// Preview functionality
document.getElementById('previewAgent').addEventListener('click', () => {
    const preview = document.getElementById('agentPreview');
    const name = document.getElementById('agentName').value || 'Unnamed Agent';
    const icon = document.getElementById('agentIcon').value;
    const description = document.getElementById('agentDescription').value || 'No description provided';
    const tone = document.getElementById('agentTone').selectedOptions[0].text.split(' - ')[0];
    const llm = document.getElementById('llmTarget').selectedOptions[0].text.split(' ')[0];
    const tools = document.querySelectorAll('input[name="tools"]:checked').length;
    
    preview.querySelector('.preview-icon').textContent = icon;
    preview.querySelector('.preview-name').textContent = name;
    preview.querySelector('.preview-description').textContent = description;
    preview.querySelector('.preview-details').innerHTML = `
        <span class="detail-item">Tone: <strong>${tone}</strong></span>
        <span class="detail-item">LLM: <strong>${llm}</strong></span>
        <span class="detail-item">Tools: <strong>${tools}</strong></span>
    `;
    
    preview.style.display = 'block';
});

// Copy agent ID
window.copyAgentId = function() {
    const agentId = document.getElementById('agentId').textContent;
    navigator.clipboard.writeText(agentId);
    window.dashboard.showNotification('Agent ID copied to clipboard', 'success');
};

// Toggle monetization options
window.toggleMonetization = function() {
    const isChecked = document.getElementById('monetizeAgent').checked;
    document.getElementById('monetizationOptions').style.display = isChecked ? 'block' : 'none';
};
</script>
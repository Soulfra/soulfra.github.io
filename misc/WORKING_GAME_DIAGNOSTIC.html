<!DOCTYPE html>
<html>
<head>
<title>Diagnostic - What's Actually Working</title>
<style>
body { 
    background: #000; 
    color: #fff; 
    font-family: Arial; 
    padding: 20px;
}
.status { 
    margin: 20px; 
    padding: 20px; 
    background: #1a1a1a; 
    border-radius: 10px;
}
.online { color: #00ff88; }
.offline { color: #ff4444; }
h1 { color: #00ff88; }
</style>
</head>
<body>

<h1>SOULFRA DIAGNOSTIC</h1>

<div class="status">
    <h2>What's Actually Running:</h2>
    <div id="services"></div>
</div>

<div class="status">
    <h2>Game Links (Try These):</h2>
    <ul>
        <li>Port 9001 Enhanced Game: <a href="http://localhost:9001" style="color: #00ff88;">http://localhost:9001</a> (Socket.io multiplayer)</li>
        <li>Port 9000 Original Game: <a href="http://localhost:9000" style="color: #00ff88;">http://localhost:9000</a> (Three.js arena)</li>
        <li>Port 8888 Simple Game: <a href="http://localhost:8888" style="color: #00ff88;">http://localhost:8888</a> (No dependencies)</li>
        <li>Port 7777 No-Emoji Game: <a href="http://localhost:7777" style="color: #00ff88;">http://localhost:7777</a> (Plain text)</li>
        <li>Port 4040 Cal Dashboard: <a href="http://localhost:4040" style="color: #00ff88;">http://localhost:4040</a></li>
    </ul>
</div>

<div class="status">
    <h2>Common Issues:</h2>
    <ul>
        <li><b>Blank screen with 2 squares:</b> Three.js loaded but no character created yet</li>
        <li><b>H key not working:</b> Need to click on game canvas first to focus</li>
        <li><b>No character creator:</b> It should appear on initial load - try refreshing</li>
        <li><b>Socket errors:</b> Check browser console (F12)</li>
    </ul>
</div>

<div class="status">
    <h2>Test Socket.io Connection:</h2>
    <button onclick="testSocket()">Test Port 9001</button>
    <button onclick="testSocket2()">Test Port 9000</button>
    <div id="socketStatus"></div>
</div>

<div class="status">
    <h2>Quick Fix - Working Game RIGHT NOW:</h2>
    <p>If the fancy games aren't working, here's a simple one that WILL work:</p>
    <iframe src="http://localhost:8888" style="width: 100%; height: 600px; border: 2px solid #00ff88; border-radius: 10px;"></iframe>
</div>

<script>
// Check services
async function checkServices() {
    const ports = [9001, 9000, 8888, 7777, 4040, 3003];
    const div = document.getElementById('services');
    
    for (const port of ports) {
        try {
            const response = await fetch(`http://localhost:${port}`, { 
                method: 'HEAD',
                mode: 'no-cors'
            });
            div.innerHTML += `<div class="online">✓ Port ${port} is ONLINE</div>`;
        } catch (e) {
            div.innerHTML += `<div class="offline">✗ Port ${port} is OFFLINE</div>`;
        }
    }
}

function testSocket() {
    const status = document.getElementById('socketStatus');
    try {
        const script = document.createElement('script');
        script.src = 'https://cdn.socket.io/4.5.4/socket.io.min.js';
        script.onload = () => {
            const socket = io('http://localhost:9001');
            socket.on('connect', () => {
                status.innerHTML = '<div class="online">✓ Socket.io connected to port 9001!</div>';
            });
            socket.on('connect_error', (err) => {
                status.innerHTML = '<div class="offline">✗ Socket.io error: ' + err.message + '</div>';
            });
        };
        document.head.appendChild(script);
    } catch (e) {
        status.innerHTML = '<div class="offline">✗ Failed to load Socket.io</div>';
    }
}

function testSocket2() {
    const status = document.getElementById('socketStatus');
    try {
        const script = document.createElement('script');
        script.src = 'https://cdn.socket.io/4.5.4/socket.io.min.js';
        script.onload = () => {
            const socket = io('http://localhost:9000');
            socket.on('connect', () => {
                status.innerHTML = '<div class="online">✓ Socket.io connected to port 9000!</div>';
            });
            socket.on('connect_error', (err) => {
                status.innerHTML = '<div class="offline">✗ Socket.io error: ' + err.message + '</div>';
            });
        };
        document.head.appendChild(script);
    } catch (e) {
        status.innerHTML = '<div class="offline">✗ Failed to load Socket.io</div>';
    }
}

checkServices();
</script>

</body>
</html>